<!doctype html>
<html>

<head>
  <title>destation</title>
  <link rel="stylesheet" type="text/css" href="main.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
</head>
<script src='/socket.io/socket.io.js'></script>
<script>
  const socket = io();
  function startTime() {
    const today = new Date();
    let h = today.getHours();
    let m = today.getMinutes();
    // let s = today.getSeconds();
    m = checkTime(m);
    // s = checkTime(s);
    document.getElementById('clock').innerHTML = h + ":" + m;
    setTimeout(startTime, 1000);
  }

  function checkTime(i) {
    if (i < 10) { i = "0" + i };  // add zero in front of numbers < 10
    return i;
  }

  socket.on('arrivals', arrivals => {
    // console.log(arrivals)
    arrivalsElem = document.getElementById('arrivals');
    arrivalsElem.innerHTML = '';

    for(const[line, trains] of Object.entries(arrivals)) {
      lineElem = document.createElement('div');
      lineElem.setAttribute('class', 'line');
      lineElem.innerHTML = `<h2>${line}`;
      for(let train of trains){
        trainElem = document.createElement('div');
        trainElem.setAttribute('class', 'train');
        trainElem.innerHTML = `<b>${train['destination']}</b> ${train['mins']}`;
        // console.log(train);
        lineElem.appendChild(trainElem);
      };
      arrivalsElem.appendChild(lineElem);
    };
  })

</script>

<body onload="startTime()">
  <div class="container">
    <div class="block block1">
      <div id="clock"></div>
    </div>
    <!-- <div class="block block2"> -->
    <!-- </div> -->
    <div class="block block2">
      <div id="arrivals">
      </div>
    </div>

    <!-- <div class="block block4"> -->
      <!-- <iframe src="https://calendar.google.com/calendar/embed?height=600&wkst=2&ctz=Europe%2FLondon&showPrint=0&showTitle=0&showTabs=0&showTz=0&mode=AGENDA&showDate=0&showCalendars=0&src=YW50b255dmlkbGVyQGdtYWlsLmNvbQ&src=Zjk2NjdmOTU3NDcwOGNkYWIwODMyOGZiOWNiNTI5MmI3MGJmOGMzNTM0ODI4YWRhN2UzZDYxYmQxZTlhOGYwMkBncm91cC5jYWxlbmRhci5nb29nbGUuY29t&src=MWVmMTkxOTgwZjFhODc0Njc3MDJhYmYzOTAwOWI4NzdjMDVlYmVlOWVmYzkzMGZkNWM3NTMwZDAyMWFjNWQ1OUBncm91cC5jYWxlbmRhci5nb29nbGUuY29t&src=aW04Y3ZsdTllbjE5OGk0aTYxYzVnbGp2azZqaXY0cGlAaW1wb3J0LmNhbGVuZGFyLmdvb2dsZS5jb20&src=ZW4tZ2IudWsjaG9saWRheUBncm91cC52LmNhbGVuZGFyLmdvb2dsZS5jb20&src=M25zcW5vZTBuMjMzc2VxbzdqN3E4Nm41bmNsN2FzMHNAaW1wb3J0LmNhbGVuZGFyLmdvb2dsZS5jb20&src=Mm1iaGE1OWI5czgxZG51NGJqNWMxYzUzMzBwN2k1cGJAaW1wb3J0LmNhbGVuZGFyLmdvb2dsZS5jb20&color=%23039be5&color=%237986cb&color=%23ad1457&color=%23009688&color=%230b8043&color=%23e67c73&color=%23d81b60" style="border-width:0" width="100%" height="600" frameborder="0" scrolling="no"></iframe> -->
    <!-- </div> -->
  </div>
</body>

</html>